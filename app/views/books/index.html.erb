<div class='container px-5 px-sm-0'>
   <div id="error_explanation">
        <% if @book.errors.any? %>
            <h3><%= @book.errors.count %>errors prohibited this obj from being saved:</h3>
            <ul><% @book.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
            </ul>
          <% end %>
        </div>

  <div class="row">


<%= render 'users/list', user:@user %>


<div class="col-md-8 offset-md-1">
      <h2>Books</h2>
      <table class="table table-hover table-inverse">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>Opinion</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <tbody>
<% @books.each do |book| %>
      <tr>
        <td><%= link_to user_path(book.user) do %>
<%= attachment_image_tag book.user, :profile_image, fallback: "no_image.jpg", size: "40x40"  %>
<% end %>
</td>

        <td><%= link_to book.title, book_path(book.id), class: 'book_id' %></td>
        <td><%= book.body %></td>

         <!--いいね機能の追加-->
          <!--ログインユーザーがFavoritesテーブルに存在するか判定-->
          <% if book.favorited_by?(current_user) %>
            <td>
              <!--存在すれば♥とその数を表示。linkを押せばテーブルから削除-->
              <%= link_to book_favorites_path(book), method: :delete do %>
                ♥<%= book.favorites.count %>
              <% end %>
            </td>
            <% else %>
            <td>
              <!--存在しなければ♡とテーブルに登録された数を表示。linkを押せばテーブルに登録-->
              <%= link_to book_favorites_path(book), method: :post do %>
                ♡<%= book.favorites.count %>
              <% end %>
            </td>
          <% end %>
            <td>コメント件数:<%= book.book_comments.count %></td>
      </tr>
<% end %>
  </tbody>
</table>
    </div>

    </div>
    </div>